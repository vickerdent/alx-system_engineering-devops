Handling loops and conditions in bash scripting